DROP TABLE TB_MEMBER CASCADE CONSTRAINTS;
DROP TABLE "TB_BOOK" CASCADE CONSTRAINTS;
DROP TABLE "TB_BOOK_RESERVES";
DROP TABLE "TB_BOOK_CART";
DROP TABLE "TB_RENT_MASTER" CASCADE CONSTRAINTS;
DROP TABLE "TB_RENT_BOOK" CASCADE CONSTRAINTS;
DROP TABLE "TB_RENT_HISTORY";
DROP TABLE "TB_FILE";
DROP TABLE "TB_BOARD";
DROP TABLE "TB_CODE";

CREATE TABLE "TB_MEMBER" (
	"USER_ID"	VARCHAR2(30 CHAR)		PRIMARY KEY, 
	"PASSWORD"	VARCHAR2(60 CHAR)		NOT NULL,
	"EMAIL"	VARCHAR2(50 CHAR)		NOT NULL,
	"GRADE"	CHAR(4 CHAR)	DEFAULT 'ME00'	NULL,
	"TELL"	VARCHAR2(15 CHAR)		NULL,
	"REG_DATE"	DATE	DEFAULT SYSDATE	NULL,
	"RENTABLE_DATE"	DATE	DEFAULT TO_DATE(SYSDATE,'YYYY/MM/DD')	NULL,
	"IS_LEAVE"	NUMBER	DEFAULT 0	NOT NULL	
);

CREATE TABLE "TB_BOOK" (
	"B_IDX"	NUMBER		PRIMARY KEY, 
	"ISBN"	VARCHAR2(100 CHAR)		NULL,
	"CATEGORY"	CHAR(4 CHAR)		NULL,
	"TITLE"	VARCHAR2(100 CHAR)		NOT NULL,
	"AUTHOR"	VARCHAR2(100 CHAR)		NOT NULL,
	"INFO"	VARCHAR2(500 CHAR)		NULL,
	"BOOK_AMT"	NUMBER	DEFAULT 1	NULL,
	"REG_DATE"	DATE	DEFAULT SYSDATE	NULL,
	"RENT_CNT"	NUMBER(6)	DEFAULT 0	NULL
);

CREATE TABLE "TB_BOOK_RESERVES" (
	"RES_IDX"	NUMBER		PRIMARY KEY, 
	"B_IDX"	NUMBER		NOT NULL,
	"REG_DATE"	DATE	DEFAULT SYSDATE	NULL,
	"STATE"	VARCHAR2(4CHAR)	DEFAULT 'RS00'	NULL,
	CONSTRAINT FK_BOOK_RESERVES FOREIGN KEY (B_IDX) REFERENCES TB_BOOK(B_IDX)

);

CREATE TABLE "TB_BOOK_CART" (
	"BC_IDX"	NUMBER		PRIMARY KEY, 
	"B_IDX"	NUMBER		NOT NULL,
	"USER_ID"	varchar2(30char)		NULL,
	"SESSION_ID"	VARCHAR2(100 CHAR)		NULL,
	"REG_DATE"	DATE	DEFAULT SYSDATE	NULL,
	CONSTRAINT FK_BOOK_CART FOREIGN KEY (B_IDX) REFERENCES TB_BOOK(B_IDX)

);

CREATE TABLE "TB_RENT_MASTER" (
	"RM_IDX"	NUMBER		PRIMARY KEY, 
	"USER_ID"	VARCHAR2(30 CHAR)		NOT NULL,
	"REG_DATE"	DATE	DEFAULT SYSDATE	NULL,
	"IS_RETURN"	NUMBER	DEFAULT 0	NULL,
	"TITLE"	VARCHAR2(300 CHAR)		NOT NULL,
	"RENT_BOOK_CNT"	NUMBER		NOT NULL,	
	CONSTRAINT FK_RENT_MASTER FOREIGN KEY (USER_ID) REFERENCES TB_MEMBER(USER_ID)
);

CREATE TABLE "TB_RENT_BOOK" (
	"RB_IDX"	NUMBER		PRIMARY KEY, 
	"RM_IDX"	NUMBER		NOT NULL,
	"B_IDX"	NUMBER		NOT NULL,
	"REG_DATE"	DATE	DEFAULT SYSDATE	NULL,
	"STATE"	VARCHAR2(4 CHAR)	DEFAULT 'RE00'	NULL,
	"RETURN_DATE"	DATE	DEFAULT TO_DATE(SYSDATE,'YYYY/MM/DD')+7	NULL,
	"EXTENTION_CNT"	NUMBER	DEFAULT 0	NULL,
	CONSTRAINT FK_RENT_BOOK FOREIGN KEY (RM_IDX) REFERENCES TB_RENT_MASTER(RM_IDX)
);

CREATE TABLE "TB_RENT_HISTORY" (
	"RH_IDX"	NUMBER		PRIMARY KEY, 
	"RM_IDX"	NUMBER		NOT NULL,
	"RB_IDX"	NUMBER		NOT NULL,
	"B_IDX"	NUMBER		NULL,
	"REG_DATE"	DATE		NULL,
	"STATE"	CHAR(4 CHAR)		NULL,
	CONSTRAINT FK_RENT_HISTORY FOREIGN KEY (RM_IDX) REFERENCES TB_RENT_MASTER(RM_IDX),
	CONSTRAINT FK_RENT_HISTORY_BOOK FOREIGN KEY (RB_IDX) REFERENCES TB_RENT_BOOK(RB_IDX)
);

CREATE TABLE "TB_FILE" (
	"F_IDX"	NUMBER		PRIMARY KEY, 
	"TYPE_IDX"	NUMBER		NOT NULL,
	"TYPE"	VARCHAR2(30CHAR)		NOT NULL,
	"ORIGIN_FILE_NAME"	VARCHAR2(260 CHAR)		NOT NULL,
	"RENAME_FILE_NAME"	VARCHAR2(260 CHAR)		NOT NULL,
	"SAVE_PATH"	VARCHAR2(260 CHAR)		NOT NULL,
	"REG_DATE"	DATE	DEFAULT SYSDATE	NULL,
	"IS_DEL"	NUMBER	DEFAULT 0	NULL
);


CREATE TABLE "TB_BOARD" (
	"BD_IDX"	NUMBER		PRIMARY KEY, 
	"USER_ID"	VARCHAR2(30 CHAR)		NOT NULL,
	"REG_DATE"	DATE	DEFAULT sysdate	NOT NULL,
	"TITLE"	VARCHAR2(50 CHAR)		NOT NULL,
	"CONTENT"	VARCHAR2(2000 CHAR)		NOT NULL,
	"IS_DEL"	NUMBER	DEFAULT 0	NULL,	
	CONSTRAINT FK_BOARD_MEMBER FOREIGN KEY (USER_ID) REFERENCES TB_MEMBER(USER_ID)
	
);

CREATE TABLE "TB_CODE" (
	"CODE"	VARCHAR2(4 CHAR)		PRIMARY KEY, 
	"UPPER_CD"	VARCHAR(4 CHAR)		NULL,
	"INFO"	VARCHAR2(300 CHAR)		NOT NULL,
	"REG_DATE"	DATE	DEFAULT SYSDATE	NULL
);